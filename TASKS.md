# wall-todo タスク一覧

## フェーズ0: 技術検証（スパイク）

- [x] **0-1. Todoist API疎通確認**
  - curlで`GET /rest/v2/tasks?filter=today`を叩く
  - 受け入れ条件: JSONでタスクが返ってくる、レスポンス形式を確認

- [x] **0-2. WeasyPrint動作確認**
  - 最小限のHTMLをPNGに変換（WeasyPrint + PyMuPDF + Pillow）
  - 受け入れ条件: 画像ファイルが生成される

- [x] **0-3. 日本語フォント描画確認**
  - Noto Sans CJK JPで日本語テキストを含むHTMLをPNG化
  - 受け入れ条件: 文字化けせずに日本語が表示される

- [x] **0-4. 固定サイズ出力確認**
  - 480x800pxの画像が生成できるか（縦長）
  - 受け入れ条件: 出力画像のサイズが正確に480x800

---

## フェーズ1: プロジェクト基盤

- [x] **1. Pythonプロジェクト初期化**
  - `pyproject.toml`と依存関係（weasyprint, pymupdf, pillow, requests, python-dotenv, jinja2）を定義
  - black, mypyの設定を含める
  - 型定義: 関数の引数と戻り値に型ヒントを付ける（内部変数は推論に任せる）
  - 受け入れ条件: `pip install -e .` が成功する、`black --check .` が通る

- [x] **2. 環境変数管理のセットアップ**
  - `.env.example`ファイル作成、python-dotenvで読み込み
  - 受け入れ条件: テストコードで`API_KEY`環境変数が読み込める

---

## フェーズ2: Todoist API連携

- [x] **3. Todoist APIクライアント作成**
  - HTTPリクエストで`GET /rest/v2/tasks`を呼び出す関数
  - 受け入れ条件: 実際のAPIトークンで認証が通り、レスポンスが返る

- [x] **4. 今日のタスク取得機能**
  - `filter=today`パラメータで今日のタスクを取得、10件に制限
  - 受け入れ条件: 取得したタスクのcontentがコンソールに出力される

- [x] **5. API エラーハンドリング**
  - ネットワークエラー・認証エラー時に空リストを返す
  - 受け入れ条件: 無効なトークンでもクラッシュせず、空リストが返る

---

## フェーズ3: HTMLテンプレートと画像生成

- [ ] **6. HTMLテンプレート作成（基本構造）**
  - Jinja2テンプレートで`templates/board.html`作成
  - 受け入れ条件: ダミーデータでHTMLファイルが生成され、ブラウザで表示できる

- [ ] **7. CSSスタイリング（仕様準拠）**
  - 480x800px（縦長）、Noto Sans JP 20px、カード風デザイン（角丸4px、枠線1px）
  - 受け入れ条件: ブラウザで開いて仕様通りのデザインが確認できる

- [ ] **8. テキスト省略処理**
  - 30文字以上のタスク名を「...」で省略
  - 受け入れ条件: 31文字以上のテキストが30文字+「...」に省略される

- [ ] **9. 最終更新時刻の表示**
  - 画面下部に`2025-12-15 14:23`形式で表示
  - 受け入れ条件: HTMLに現在時刻が正しいフォーマットで表示される

- [ ] **10. WeasyPrintでPNG変換**
  - HTMLを480x800のPNG画像に変換（縦長）
  - 受け入れ条件: `output.png`が生成され、画像ビューアで確認できる

---

## フェーズ4: タスク0件・エラー時の表示

- [ ] **11. フォールバック画像の選択ロジック**
  - `images/`フォルダから日付ベースでランダム選択（同日は同じ画像）
  - 受け入れ条件: 同じ日に複数回実行しても同じ画像が選ばれる

- [ ] **12. タスク0件時の画像表示**
  - タスクがない場合にフォールバック画像を表示
  - 受け入れ条件: タスク0件で実行するとフォールバック画像がoutput.pngにコピーされる

---

## フェーズ5: メインスクリプト統合

- [ ] **13. main.py統合**
  - 全機能を組み合わせたエントリーポイント
  - 受け入れ条件: `python main.py`でTodoistからタスク取得→PNG生成まで完了

- [ ] **14. 動作確認とリファクタリング**
  - コードの整理、不要なprint文の削除
  - 受け入れ条件: 実際のTodoistタスクが正しくPNG画像に表示される

---

## フェーズ6: Raspberry Pi対応

- [ ] **15. e-paper描画モジュール作成**
  - waveshare-epaperライブラリでPNGを表示
  - 受け入れ条件: ラズパイ上で`python main.py`実行時にe-paperに表示される

- [ ] **16. 本番環境セットアップ手順書**
  - cron設定、ディレクトリ構成、依存関係インストール手順
  - 受け入れ条件: 手順通りに実行してラズパイで動作する

---

## 依存関係

```
フェーズ0（技術検証）
    ↓
フェーズ1 → フェーズ2 → フェーズ3 → フェーズ4 → フェーズ5 → フェーズ6
```

---

最終更新: 2025-12-16
